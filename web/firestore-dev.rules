rules_version = '2';

// Development-friendly Firestore Security Rules for Sankalp Platform
// ⚠️ WARNING: These rules are permissive and should only be used for development/testing
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Helper function to check if user is authenticated
    function isAuthenticated() {
      return request.auth != null;
    }
    
    // NGO Image Submissions - Allow all authenticated operations
    match /ngo_image_submissions/{submissionId} {
      allow read, write: if isAuthenticated();
    }
    
    // NGO Profiles - Allow all operations for testing
    match /ngo_profiles/{profileId} {
      allow read: if true; // Public read for leaderboard
      allow write: if isAuthenticated(); // Authenticated write for sample data
    }
    
    // Donations Collection - Allow all operations for testing
    match /donations/{donationId} {
      allow read: if true; // Public read for transparency
      allow write: if isAuthenticated(); // Authenticated write for donations
    }
    
    // NGO Spendings Collection - Allow all operations for testing
    match /ngo_spendings/{spendingId} {
      allow read: if true; // Public read for transparency
      allow write: if isAuthenticated(); // Authenticated write for spending
    }
    
    // Issues (Public reporting) - Allow all operations
    match /issues/{issueId} {
      allow read: if true; // Public read
      allow write: if isAuthenticated(); // Authenticated write
    }
    
    // User Profiles - Allow authenticated operations
    match /users/{userId} {
      allow read, write: if isAuthenticated();
    }
    
    // School Data - Allow authenticated operations
    match /schools/{schoolId} {
      allow read, write: if isAuthenticated();
    }
    
    // School Meals - Allow authenticated operations
    match /schoolMeals/{mealId} {
      allow read, write: if isAuthenticated();
    }
    
    // BMI Records - Allow authenticated operations
    match /bmiRecords/{recordId} {
      allow read, write: if isAuthenticated();
    }
    
    // Volunteers - Allow authenticated operations
    match /volunteers/{volunteerId} {
      allow read: if true; // Public read for leaderboard
      allow write: if isAuthenticated(); // Authenticated write
    }
    
    // Default rule - allow authenticated users to read/write
    match /{document=**} {
      allow read, write: if isAuthenticated();
    }
  }
}
